library(terra)
library(tidyverse)
library(patchwork)
library(MetBrewer)
library(sf)
#####################################################
##                                                 ##
##   Pinniped Fisheries Interaction Meta-Analysis  ##
##                                                 ##
## Spatial Conflict potential - analyses and plots ##
##                                                 ##
##               JJ- Jun 21st 2023                 ##
##                                                 ##
#####################################################
rm(list = ls())
options(width = 100)
memory.limit(size = 60000) ## Increase memory limit to allocate bigger vectors for the rasters
library(raster)
library(terra)
library(tidyverse)
library(patchwork)
library(MetBrewer)
library(sf)
##______________________________________________________________________________
#### 1. Loading data ####
## Conflict potential raster
conflict_potential <- rast(x = "data/potential_pinniped_conflict_allpin.tif")
## Convert conflict to df with terra
conflict_df <- as.data.frame(x = conflict_potential, xy = TRUE)
## Operational interaction + spatial data
load("data/pinnrev_sf.RData")
load("data/op_interaction.RData")
load("data/pinnrev_centroid_data.RData")
## Overall world map
world_map <- st_read("data/ne_10m_land.shp")
## Overall world map
world_map <- st_read("../../Figures/Natural_Earth_Land_data/ne_10m_land.shp")
plot(world_map)
#####################################################
##                                                 ##
##   Pinniped Fisheries Interaction Meta-Analysis  ##
##                                                 ##
## Spatial Conflict potential - analyses and plots ##
##                                                 ##
##               JJ- Jun 21st 2023                 ##
##                                                 ##
#####################################################
rm(list = ls())
options(width = 100)
memory.limit(size = 60000) ## Increase memory limit to allocate bigger vectors for the rasters
library(raster)
library(terra)
library(tidyverse)
library(patchwork)
library(MetBrewer)
library(sf)
##______________________________________________________________________________
#### 1. Loading data ####
## Conflict potential raster
conflict_potential <- rast(x = "data/potential_pinniped_conflict_allpin.tif")
## Convert conflict to df with terra
conflict_df <- as.data.frame(x = conflict_potential, xy = TRUE)
## Operational interaction + spatial data
load("data/pinnrev_sf.RData")
load("data/op_interaction.RData")
load("data/pinnrev_centroid_data.RData")
## Overall world map - I am not hosting data, but this publicly available from https://www.naturalearthdata.com/
world_map <- st_read("../../Figures/Natural_Earth_Land_data/ne_10m_land.shp")
## Colour
conflict_colour <- "#7301A8FF"
##______________________________________________________________________________
#### 2. Linking to conflict values to operational interaction data ####
## extract raster values for the study geometries
pinnrev_mnconf <- pinnrev_sf %>%
mutate(potential_conflict = raster::extract(conflict_potential,
pinnrev_sf, fun = mean, na.rm = TRUE)[,2]) %>%
dplyr::select(acc_no, potential_conflict) %>%
as_tibble()
## Adding to operational interaction data
op_interaction <- op_interaction %>%
left_join(x = ., y = pinnrev_mnconf, by = "acc_no")
ggplot() +
geom_tile(data = conflict_df,
aes(x = x, y = y, fill = potential_pinniped_conflict_allpin)) +
geom_sf(data = pinnrev_centroids, colour = "black",
size = 2.5, aes(shape = "Quantitative"), alpha = 1) +
geom_sf(data = pinnrev_centroids_survey, colour = "black",
size = 2, aes(shape = "Non-standardised"), alpha = 1) +
scale_fill_gradient2(low = "grey99", mid = "grey91",
high = "#7301A8FF") +
scale_shape_manual(values = c(2,1)) +
guides(fill = guide_colorbar(barheight = 10, barwidth = 2)) +
labs(fill = "Potential for\npinniped-fishery\ninteractions", shape = "Data type") +
theme_void()
ggsave(pinniped_conflict_studies,
filename = "output/figure_4.pdf",
width = 25, height = 20, units = "cm")
pinniped_conflict_studies <- ggplot() +
geom_tile(data = conflict_df,
aes(x = x, y = y, fill = potential_pinniped_conflict_allpin)) +
geom_sf(data = pinnrev_centroids, colour = "black",
size = 2.5, aes(shape = "Quantitative"), alpha = 1) +
geom_sf(data = pinnrev_centroids_survey, colour = "black",
size = 2, aes(shape = "Non-standardised"), alpha = 1) +
scale_fill_gradient2(low = "grey99", mid = "grey91",
high = "#7301A8FF") +
scale_shape_manual(values = c(2,1)) +
guides(fill = guide_colorbar(barheight = 10, barwidth = 2)) +
labs(fill = "Potential for\npinniped-fishery\ninteractions", shape = "Data type") +
theme_void()
ggsave(pinniped_conflict_studies,
filename = "output/figure_4.pdf",
width = 25, height = 20, units = "cm")
##______________________________________________________________________________
#### 4. Observed conflict vs. potential ####
## Potential for interactions density + observations
dat_dens1 <- ggplot(conflict_df, aes(x = potential_pinniped_conflict_allpin)) +
geom_histogram(bins = 20, fill = "black") +
geom_vline(data = op_interaction,
aes(xintercept = potential_conflict),
colour = conflict_colour, alpha = 0.8) +
coord_cartesian(xlim = c(0,1)) +
labs(x = NULL,
y = "Frequency") +
theme_bw(base_size = 13) +
theme(panel.grid = element_blank())
dat_dens2 <- ggplot(op_interaction, aes(x = potential_conflict, y = "")) +
geom_boxplot(fill = conflict_colour) +
coord_cartesian(xlim = c(0,1)) +
labs(x = "Potential for pinniped-fishery interactions",
y = "") +
theme_bw(base_size = 13) +
theme(panel.grid = element_blank())
ggsave(dat_dens1 / dat_dens2 + plot_layout(heights = c(2,1)),
filename = "output/figure_s5.jpeg",
width = 18, height = 10, units = "cm", dpi = 1500)
ggsave(dat_dens1 / dat_dens2 + plot_layout(heights = c(2,1)),
filename = "output/figS5.jpeg",
width = 18, height = 10, units = "cm", dpi = 1500)
## Rasters and df
conflict_nogfw <- rast(x = "data/potential_pinniped_conflict_nogfw.tif")
conflict_noshore <- rast(x = "data/potential_pinniped_conflict_noshore.tif")
## Convert conflict to df with terra
nogfw_df <- as.data.frame(x = conflict_nogfw, xy = TRUE)
noshore_df <- as.data.frame(x = conflict_noshore, xy = TRUE)
# extract potential conflict of all layers
pinnrev_mnconf_full <- pinnrev_sf %>%
mutate(potential_conflict = raster::extract(conflict_potential, pinnrev_sf, fun = mean, na.rm = TRUE)[,2],
potential_conflict_nogfw = raster::extract(conflict_nogfw, pinnrev_sf, fun = mean, na.rm = TRUE)[,2],
potential_conflict_noshore = raster::extract(conflict_noshore, pinnrev_sf, fun = mean, na.rm = TRUE)[,2]) %>%
as_tibble() %>%
dplyr::select(acc_no, potential_conflict:potential_conflict_noshore) %>%
pivot_longer(- acc_no)
## plots
pinniped_conflict_full <- ggplot() +
geom_tile(data = conflict_df,
aes(x = x, y = y, fill = potential_pinniped_conflict_allpin)) +
scale_fill_gradient2(low = "grey99", mid = "grey91",
high = "#7301A8FF") +
guides(fill = guide_colorbar(barheight = 10, barwidth = 2)) +
labs(fill = "Potential for\npinniped-fishery\ninteractions",
tag = "a)") +
theme_void(base_size = 13)
pinniped_conflict_nogfw <- ggplot() +
geom_tile(data = nogfw_df,
aes(x = x, y = y, fill = potential_pinniped_conflict_nogfw)) +
scale_fill_gradient2(low = "grey99", mid = "grey91",
high = "#194B5D") +
guides(fill = guide_colorbar(barheight = 10, barwidth = 2)) +
labs(fill = "Potential for\npinniped-fishery\ninteractions",
tag = "b)") +
theme_void(base_size = 13)
pinniped_conflict_noshore <- ggplot() +
geom_tile(data = noshore_df,
aes(x = x, y = y, fill = potential_pinniped_conflict_noshore)) +
scale_fill_gradient2(low = "grey99", mid = "grey91",
high = "#0D0887FF") +
guides(fill = guide_colorbar(barheight = 10, barwidth = 2)) +
labs(fill = "Potential for\npinniped-fishery\ninteractions",
tag = "c)") +
theme_void(base_size = 13)
ggsave(pinniped_conflict_full / pinniped_conflict_nogfw / pinniped_conflict_noshore,
filename = "output/figS6.jpeg",
width = 25, height = 40, units = "cm", dpi = 800)
ggplot(pinnrev_mnconf_full, aes(x = name, y = value, fill = name)) +
geom_violin() +
stat_summary(geom = "point", fun = "mean")
#####################################################
##                                                 ##
##   Pinniped Fisheries Interaction Meta-Analysis  ##
##                                                 ##
##           Underlying raster layer plots         ##
##                                                 ##
##               JJ- Jun 21st 2023                 ##
##                                                 ##
#####################################################
rm(list = ls())
options(width = 100)
library(raster)
library(terra)
library(tidyverse)
library(patchwork)
library(MetBrewer)
library(sf)
##______________________________________________________________________________
#### 1. Loading raw data ####
## A) Global Fishing data - I am not hosting data publicly, but available from https://globalfishingwatch.org/
GFW_raster_norm <- rast(x = "../../Figures/spatial_raster_data/GFW_raster_norm.tif")
## B) Distance to shore - I am not hosting data publicly, but available from https://oceancolor.gsfc.nasa.gov/resources/docs/distfromcoast/
coast_proximity <- rast("../../Figures/spatial_raster_data/coast_proximity.tif")
## C) Pinniped data - raster and sf - I am not hosting data publicly, but available from IUCN red list
pinn_raster <- rast("../../Figures/spatial_raster_data/pinn_raster.tif")
pinn_all_raster <- rast("../../Figures/spatial_raster_data/pinn_all_raster.tif")
load("../../Data/pinniped_sf_dat.RData")
## D) overall world map - I am not hosting data, but this publicly available from https://www.naturalearthdata.com/
world_map <- st_read("../../Figures/Natural_Earth_Land_data/ne_10m_land.shp")
## Converting rasters to data frames with terra
GFW_df <- as.data.frame(x = GFW_raster_norm, xy = TRUE)
coast_df <- as.data.frame(x = coast_proximity, xy = TRUE)
pinn_df <- as.data.frame(x = pinn_raster, xy = TRUE)
pinn_all_df <- as.data.frame(x = pinn_all_raster, xy = TRUE)
##______________________________________________________________________________
#### 2. Plots ####
## A) Global Fishing data
GFW_plot <- ggplot() +
geom_sf(data = world_map, fill = "lightgrey", colour = "lightgrey", size = 0.01) +
geom_raster(data = GFW_df, aes(x = x, y = y, fill = GFW_raster_norm)) +
scale_fill_viridis_c() +
guides(fill = guide_colorbar(barheight = 8, barwidth = 2)) +
labs(fill = "Fishing effort", tag = "a)") +
theme_void()
## B) Distance to shore
coast_proximity_plot <- ggplot() +
geom_sf(data = world_map, fill = "white", colour = "white", size = 0.01) +
geom_tile(data = coast_df, aes(x = x, y = y, fill = coast_proximity)) +
scale_fill_viridis_c(option = "C") +
guides(fill = guide_colorbar(barheight = 8, barwidth = 2)) +
labs(fill = "Proximity\nto coast", tag = "c)") +
theme_void()
## C) Pinnipeds
pinn_df <- filter(pinn_df, pinn_raster > 0.01)
pinn_all_df <- filter(pinn_all_df, pinn_all_raster > 0.01)
pinn_all_plot <- ggplot() +
geom_sf(data = world_map, fill = "lightgrey", colour = "lightgrey", size = 0.01) +
geom_tile(data = pinn_all_df, aes(x = x, y = y, fill = pinn_all_raster),
show.legend = F) +
scale_fill_viridis_c(begin = 0, end = 0.4) +
labs(tag = "b)") +
theme_void()
ggsave(GFW_plot / pinn_all_plot / coast_proximity_plot,
filename = "output/figS4.jpeg",
width = 25, height = 19, units = "cm", dpi = 1200)
##______________________________________________________________________________
#### 1. Loading and wrangling ####
## Interaction data - updated coordinates for manuscript write up
pinnrev <- read_csv("data/scoping_data_extraction_20240412.csv") %>%
mutate(spp = paste0(genus, " ", species))
glimpse(pinnrev)
## Operational interaction data
load("data/op_interaction.RData", verbose = TRUE)
## non-standardised data
load("data/survey_data_July2022.RData")
old_survey_data <- survey_data
nonstn_data <- read_csv("data/non_standardised_data_20230112.csv") %>%
left_join(dplyr::select(old_survey_data, c(1,2,5)), by= "acc_no")
nonstn_data$modality
nonstn_data[c(13,14,16), "modality"] <- c("Proportion of fishers",
"Self reporting", "Self reporting")
nonstn_data[c(8:10,15),5] <- c("Gonzalez and de Larrinoa 2013",
"Gonzalez and de Larrinoa 2013",
"Guclusoy 2008",
"Sepulveda and Oliva 2005")
nonstn_data[c(13,14,16),"study_name"] <- c("Mo et al. 2011",
"Karamanlidis et al. 2020",
"Kauppinen et al. 2005")
#####################################################
##                                                 ##
##   Pinniped Fisheries Interaction Meta-Analysis  ##
##                                                 ##
##             Wrangling Coordinates               ##
##                                                 ##
##              JJ- June 26th 2024                 ##
##                                                 ##
#####################################################
rm(list = ls())
options(width = 100)
library(tidyverse)
library(MetBrewer)
library(patchwork)
library(sp)
library(sf)
library(raster)
int_colour <- MetPalettes$Hokusai2[[1]][3]
med_colour <- MetPalettes$Hokusai3[[1]][2]
dmg_colour <- MetPalettes$Hokusai2[[1]][6]
##______________________________________________________________________________
#### 1. Loading and wrangling ####
## Interaction data - updated coordinates for manuscript write up
pinnrev <- read_csv("data/scoping_data_extraction_20240412.csv") %>%
mutate(spp = paste0(genus, " ", species))
glimpse(pinnrev)
## Operational interaction data
load("data/op_interaction.RData", verbose = TRUE)
## non-standardised data
load("data/survey_data_July2022.RData")
old_survey_data <- survey_data
nonstn_data <- read_csv("data/non_standardised_data_20230112.csv") %>%
left_join(dplyr::select(old_survey_data, c(1,2,5)), by= "acc_no")
nonstn_data$modality
nonstn_data[c(13,14,16), "modality"] <- c("Proportion of fishers",
"Self reporting", "Self reporting")
nonstn_data[c(8:10,15),5] <- c("Gonzalez and de Larrinoa 2013",
"Gonzalez and de Larrinoa 2013",
"Guclusoy 2008",
"Sepulveda and Oliva 2005")
nonstn_data[c(13,14,16),"study_name"] <- c("Mo et al. 2011",
"Karamanlidis et al. 2020",
"Kauppinen et al. 2005")
##______________________________________________________________________________
#### 2. Coordinate wrangling ####
## 2a. Northern Latitude
lat_N <- pinnrev %>% pull(lat_N)
lat_N_ds <- unlist(lapply(str_split(lat_N, pattern = " "), function(x){
if(length(x) < 3 | all(is.na(x))){lat_ds = NA}
else if(as.numeric(x[1]) < 0){
lat_ds = paste0(abs(as.numeric(x[1])), "d", x[2], "'", x[3], "\"S")
lat_ds = as.numeric(sp::char2dms(lat_ds))}
else{lat_ds = paste0(x[1], "d", x[2], "'", x[3], "\"N")
lat_ds = as.numeric(sp::char2dms(lat_ds))}
return(lat_ds)
}))
## 2b. Southern Latitude
lat_S <-  pinnrev %>% pull(lat_S)
lat_S_ds <- unlist(lapply(str_split(lat_S, pattern = " "), function(x){
if(length(x) < 3 | all(is.na(x))){lat_ds = NA}
else if(as.numeric(x[1]) < 0){
lat_ds = paste0(abs(as.numeric(x[1])), "d", x[2], "'", x[3], "\"S")
lat_ds = as.numeric(sp::char2dms(lat_ds))}
else{lat_ds = paste0(x[1], "d", x[2], "'", x[3], "\"N")
lat_ds = as.numeric(sp::char2dms(lat_ds))}
return(lat_ds)
}))
## 2c. Western Longitude
lon_W <- pinnrev %>% pull(long_W)
lon_W_ds <- unlist(lapply(str_split(lon_W, pattern = " "), function(x){
if(length(x) < 3 | all(is.na(x))){lon_ds = NA}
else if(as.numeric(x[1]) < 0){
lon_ds = paste0(abs(as.numeric(x[1])), "d", x[2], "'", x[3], "\"W")
lon_ds = as.numeric(sp::char2dms(lon_ds))}
else{lon_ds = paste0(x[1], "d", x[2], "'", x[3], "\"E")
lon_ds = as.numeric(sp::char2dms(lon_ds))}
return(lon_ds)
}))
## 2d. Eastern Longitude
lon_E <- pinnrev %>% pull(long_E)
lon_E_ds <- unlist(lapply(str_split(lon_E, pattern = " "), function(x){
if(length(x) < 3 | all(is.na(x))){lon_ds = NA}
else if(as.numeric(x[1]) < 0){
lon_ds = paste0(abs(as.numeric(x[1])), "d", x[2], "'", x[3], "\"W")
lon_ds = as.numeric(sp::char2dms(lon_ds))}
else{lon_ds = paste0(x[1], "d", x[2], "'", x[3], "\"E")
lon_ds = as.numeric(sp::char2dms(lon_ds))}
return(lon_ds)
}))
##______________________________________________________________________________
#### 3. Converting to spatial polygons ####
# Going through each of the coordinates and turning them into spatial polygons
spatial_poly_list <-lapply(X = 1:length(lat_N_ds), FUN = function(x){
print(x)
# curent coordiantes
clon_W = lon_W_ds[x]
clon_E = lon_E_ds[x]
clat_N = lat_N_ds[x]
clat_S = lat_S_ds[x]
# if they are the same, make them super small
if(clon_W > clon_E){clon_E = clon_E + 0.05}
if(clat_S > clat_N){clat_N = clat_N + 0.05}
# convert
cpoly = as(raster::extent(clon_W, clon_E, clat_S, clat_N), "SpatialPolygons")
proj4string(cpoly) <- "+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs"
cdat = pinnrev[x,c("acc_no","n_int","n_dmg", "x_norm")]
SpatialPolygonsDataFrame(cpoly, data = cdat)
})
# Binding all the data together to one spatial polygons dtaaframe
pinnrev_spatial <- bind_rows(lapply(X = 1:length(spatial_poly_list), FUN = function(x){
sf::st_as_sf(spatial_poly_list[[x]])
}))
pinnrev_sf <- sf::st_as_sf(pinnrev_spatial)
save(pinnrev_sf, file = "../../Data/pinnrev_sf.RData")
# Taking centroid points - having to add 17:19 and 22 separately
pinnrev_centroids <- st_centroid(pinnrev_sf[-c(13:15,19),]) %>%
mutate(n = if_else(is.na(n_int) == TRUE, as.numeric(n_dmg), n_int))
point_studies <- pinnrev %>%
slice(13:15,19) %>%
mutate(lat = lat_N_ds[c(13:15,19)], lon = lon_E_ds[c(13:15,19)],
n = if_else(is.na(n_int) == TRUE, as.numeric(n_dmg), n_int)) %>%
st_as_sf(coords = c("lon", "lat"),
crs = "+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0") %>%
dplyr::select(acc_no, n_int, n_dmg, x_norm, geometry, n)
pinnrev_centroids <- bind_rows(pinnrev_centroids, point_studies) %>%
mutate(n_dmg = as.numeric(n_dmg),
n_sum = n_int + n_dmg,
response = case_when(
is.na(n_sum) == TRUE & n_int > 0 ~ "Interaction",
is.na(n_sum) == TRUE & n_dmg > 0 ~ "Catch lost",
n_sum > 0 ~ "Both"),
response = factor(response, levels = c("Interaction", "Catch lost", "Both")))
##______________________________________________________________________________
#### 4. Survey studies ####
## 2a. Northern Latitude
lat_N <- nonstn_data %>% pull(lat_N)
lat_N_ds <- unlist(lapply(str_split(lat_N, pattern = " "), function(x){
if(length(x) < 3 | all(is.na(x))){lat_ds = NA}
else if(as.numeric(x[1]) < 0){
lat_ds = paste0(abs(as.numeric(x[1])), "d", x[2], "'", x[3], "\"S")
lat_ds = as.numeric(sp::char2dms(lat_ds))}
else{lat_ds = paste0(x[1], "d", x[2], "'", x[3], "\"N")
lat_ds = as.numeric(sp::char2dms(lat_ds))}
return(lat_ds)
}))
## 2b. Southern Latitude
lat_S <-  nonstn_data %>% pull(lat_S)
lat_S_ds <- unlist(lapply(str_split(lat_S, pattern = " "), function(x){
if(length(x) < 3 | all(is.na(x))){lat_ds = NA}
else if(as.numeric(x[1]) < 0){
lat_ds = paste0(abs(as.numeric(x[1])), "d", x[2], "'", x[3], "\"S")
lat_ds = as.numeric(sp::char2dms(lat_ds))}
else{lat_ds = paste0(x[1], "d", x[2], "'", x[3], "\"N")
lat_ds = as.numeric(sp::char2dms(lat_ds))}
return(lat_ds)
}))
## 2c. Western Longitude
lon_W <- nonstn_data %>% pull(long_W)
lon_W_ds <- unlist(lapply(str_split(lon_W, pattern = " "), function(x){
if(length(x) < 3 | all(is.na(x))){lon_ds = NA}
else if(as.numeric(x[1]) < 0){
lon_ds = paste0(abs(as.numeric(x[1])), "d", x[2], "'", x[3], "\"W")
lon_ds = as.numeric(sp::char2dms(lon_ds))}
else{lon_ds = paste0(x[1], "d", x[2], "'", x[3], "\"E")
lon_ds = as.numeric(sp::char2dms(lon_ds))}
return(lon_ds)
}))
## 2d. Eastern Longitude
lon_E <- nonstn_data %>% pull(long_E)
lon_E_ds <- unlist(lapply(str_split(lon_E, pattern = " "), function(x){
if(length(x) < 3 | all(is.na(x))){lon_ds = NA}
else if(as.numeric(x[1]) < 0){
lon_ds = paste0(abs(as.numeric(x[1])), "d", x[2], "'", x[3], "\"W")
lon_ds = as.numeric(sp::char2dms(lon_ds))}
else{lon_ds = paste0(x[1], "d", x[2], "'", x[3], "\"E")
lon_ds = as.numeric(sp::char2dms(lon_ds))}
return(lon_ds)
}))
# Going through each of the coordinates and turning them into spatial polygons
spatial_poly_list_survey <-lapply(X = 1:length(lat_N_ds), FUN = function(x){
print(x)
# curent coordiantes
clon_W = lon_W_ds[x]
clon_E = lon_E_ds[x]
clat_N = lat_N_ds[x]
clat_S = lat_S_ds[x]
# if they are the same, make them super small
if(clon_W > clon_E){clon_E = clon_E + 0.05}
if(clat_S > clat_N){clat_N = clat_N + 0.05}
# convert
cpoly = as(raster::extent(clon_W, clon_E, clat_S, clat_N), "SpatialPolygons")
proj4string(cpoly) <- "+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs"
cdat = nonstn_data[x,c("acc_no","x_int","x_dmg")]
SpatialPolygonsDataFrame(cpoly, data = cdat)
})
# Binding all the data together to one spatial polygons dtaaframe
pinnrev_spatial_survey <- bind_rows(lapply(X = 1:length(spatial_poly_list_survey), FUN = function(x){
sf::st_as_sf(spatial_poly_list_survey[[x]])
}))
# As sf object
pinnrev_sf_survey <- sf::st_as_sf(pinnrev_spatial_survey)
# centroids of survey data
pinnrev_centroids_survey <- st_centroid(pinnrev_sf_survey)
##______________________________________________________________________________
#### 5. Plots ####
world_map <- st_read("../../Figures/Natural_Earth_Land_data/ne_10m_land.shp")
eez <- st_read("../../Data/World_EEZ_v11_20191118/eez_v11.shp")
# # The CRS - Robin projection for curved edges
# myCRS <- CRS("+proj=robin +lon_0=0 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs")
plots_world <- ggplot() +
geom_sf(data = world_map, fill = "white", colour = "white", size = 0.01) +
geom_sf(data = pinnrev_centroids, shape = 16,
aes(size = (n*x_norm)  + 1, colour = response), alpha = 0.6) +
geom_sf(data = pinnrev_centroids_survey, aes(colour = "Non-standardised"),
shape = 17, size = 2, alpha = 0.8) +
scale_size_continuous(trans = "log10", breaks = c(1,10,100,1000,10000),
limits = c(1,50000), range = c(1,6)) +
scale_colour_manual(name = "Data\navailable",
breaks = c("Interaction", "Catch lost", "Both", "Non-standardised"),
values = c(int_colour, dmg_colour, "black", "grey60")) +
scale_y_continuous(expand = c(0,0)) + scale_x_continuous(expand = c(0,0)) +
guides(colour = guide_legend(keyheight = 2.1,
override.aes =
list(alpha = 1, size = 4,
shape = c(16, 16, 16, 17))),
size = guide_legend(override.aes = list(alpha = 1))) +
labs(size = "Days of\nObservation") +
theme(panel.grid = element_line(size = 0.2),
panel.background = element_rect(fill = "grey90"),
legend.key = element_rect(fill = NA),
axis.text = element_blank(), axis.ticks = element_blank())
# ggsave(plots_world, filename = "../../Figures/Manuscript_figures/world_map_studies2.pdf",
#        width = 27, height = 19, units = "cm")
ggsave(plots_world, filename = "output/world_map_studies.jpeg",
width = 27, height = 19, units = "cm", dpi = 1500)
ggsave(plots_world, filename = "output/world_map_studies.jpeg",
width = 27, height = 19, units = "cm", dpi = 1500)
